window.__require=function t(e,o,n){function r(c,a){if(!o[c]){if(!e[c]){var s=c.split("/");if(s=s[s.length-1],!e[s]){var u="function"==typeof __require&&__require;if(!a&&u)return u(s,!0);if(i)return i(s,!0);throw new Error("Cannot find module '"+c+"'")}c=s}var f=o[c]={exports:{}};e[c][0].call(f.exports,function(t){return r(e[c][1][t]||t)},f,f.exports,t,e,o,n)}return o[c].exports}for(var i="function"==typeof __require&&__require,c=0;c<n.length;c++)r(n[c]);return r}({AdditionView:[function(t,e,o){"use strict";cc._RF.push(e,"9401bswLVdPuKMgEHvN6rze","AdditionView");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,c=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(c=(i<3?r(c):i>3?r(e,o,c):r(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var i=t("../common/Const"),c=t("../prefab/Addition"),a=cc._decorator,s=a.ccclass,u=a.property,f=function(){return function(){}}(),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.item=null,e}return n(e,t),e.prototype.start=function(){for(var t=this.node.width/i.Arms_word.length,e=0;e<i.Arms_word.length;++e){var o=cc.instantiate(this.item);o.getComponent(c.default).initAddition(e),this.node.addChild(o),o.scale=1.3,o.x=-this.node.width/2+t/2+e*t,o.y=25}},e.prototype.resetAddition=function(){this.node.children.forEach(function(t,e){t.getComponent(c.default).initAddition(e)})},e.prototype.doAddition=function(t,e){var o=this,n=[],r=new f;switch(t){case i.GUA_XIANG.QIAN:for(var a=0;a<i.Arms_word.length;++a){var s=new f;s.arm=a,s.attack=.2,s.defence=.1,s.energy=3,n.push(s)}break;case i.GUA_XIANG.KAN:r.arm=i.Arms.Gong,r.attack=.6,r.defence=.2,r.energy=10,n.push(r);break;case i.GUA_XIANG.GEN:r.arm=i.Arms.Dun,r.attack=.2,r.defence=1.2,r.energy=10,n.push(r);break;case i.GUA_XIANG.ZHEN:r.arm=i.Arms.Dao,r.attack=.6,r.defence=.2,r.energy=10,n.push(r);break;case i.GUA_XIANG.XUN:r.arm=i.Arms.Qi,r.attack=1,r.defence=.2,r.energy=10,n.push(r);break;case i.GUA_XIANG.LI:r.arm=i.Arms.Jun,r.attack=.6,r.defence=.2,r.energy=10,n.push(r);break;case i.GUA_XIANG.KUN:r.arm=i.Arms.Che,r.attack=.5,r.defence=.5,r.energy=10,n.push(r);break;case i.GUA_XIANG.DUI:r.arm=i.Arms.Qiang,r.attack=.6,r.defence=.3,r.energy=10,n.push(r)}return n.forEach(function(t){var n=o.node.children[t.arm].getComponent(c.default).doAddition(t.attack*e/3,t.defence*e/3),r=n[0],i=n[1];t.attack=r,t.defence=i,t.energy*=e}),n},r([u(cc.Prefab)],e.prototype,"item",void 0),e=r([s],e)}(cc.Component);o.default=l,cc._RF.pop()},{"../common/Const":"Const","../prefab/Addition":"Addition"}],Addition:[function(t,e,o){"use strict";cc._RF.push(e,"cce52KBCnBDsavXIqTCGEVS","Addition");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,c=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(c=(i<3?r(c):i>3?r(e,o,c):r(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var i=t("../common/Const"),c=cc._decorator,a=c.ccclass,s=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lb_arm=null,e.lb_data1=null,e.lb_data2=null,e._addAttack=0,e._addDefence=0,e}return n(e,t),Object.defineProperty(e.prototype,"arm",{set:function(t){this._arm=t,this.lb_arm.string=i.Arms_word[t]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"addAttack",{get:function(){return this._addAttack},set:function(t){this._addAttack=t;var e="\u653b";this._addAttack>0?(this.lb_data1.node.color=cc.Color.GREEN,e=e+"+"+Math.floor(100*this._addAttack)+"%"):this._addAttack<0?(this.lb_data1.node.color=cc.Color.RED,e=e+Math.floor(100*this._addAttack)+"%"):(e="\u653b+0%",this.lb_data1.node.color=cc.Color.BLACK),this.lb_data1.string=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"addDefence",{get:function(){return this._addDefence},set:function(t){this._addDefence=t;var e="\u9632";this._addDefence>0?(this.lb_data2.node.color=cc.Color.GREEN,e=e+"+"+Math.floor(100*this._addDefence)+"%"):this._addDefence<0?(this.lb_data2.node.color=cc.Color.RED,e=e+Math.floor(100*this._addDefence)+"%"):(e="\u9632+0%",this.lb_data2.node.color=cc.Color.BLACK),this.lb_data2.string=e},enumerable:!1,configurable:!0}),e.prototype.initAddition=function(t){this.addAttack=0,this.addDefence=0,this.arm=t},e.prototype.doAddition=function(t,e){return this.addAttack+=t,this.addDefence+=e,[this.addAttack,this.addDefence]},r([s(cc.Label)],e.prototype,"lb_arm",void 0),r([s(cc.Label)],e.prototype,"lb_data1",void 0),r([s(cc.Label)],e.prototype,"lb_data2",void 0),e=r([a],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../common/Const":"Const"}],BuffComponent:[function(t,e,o){"use strict";cc._RF.push(e,"ff99asDq61LappWKiQBIF8I","BuffComponent");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,c=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(c=(i<3?r(c):i>3?r(e,o,c):r(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var i=t("./BuffData"),c=cc._decorator,a=c.ccclass,s=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._buffId=i.BuffId.NULL,e}return n(e,t),Object.defineProperty(e.prototype,"buffId",{get:function(){return this._buffId},set:function(t){if(this._buffId!==t){this._buffId=t;var e=i.default(t);this.buffName=e.name,this.buffIcon=e.icon,this.buffTime=e.dotime,this.continued=e.continued,this.buffType=e.type,this.doFunc=e.func}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"buffName",{get:function(){return this._buffName},set:function(t){this._buffName=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"buffIcon",{get:function(){return this._buffIcon},set:function(t){this._buffIcon=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"buffTime",{get:function(){return this._buffTime},set:function(t){this._buffTime=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"continued",{get:function(){return this._continued},set:function(t){this._continued=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"buffType",{get:function(){return this._buffType},set:function(t){this._buffType=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"doFunc",{get:function(){return this._doFunc},set:function(t){this._doFunc=t},enumerable:!1,configurable:!0}),e.prototype.initBuff=function(t){this.buffId=t},e=r([a],e)}(cc.Component));o.default=s,cc._RF.pop()},{"./BuffData":"BuffData"}],BuffData:[function(t,e,o){"use strict";var n;cc._RF.push(e,"e68415/lFtFMLRvOSn+tK/j","BuffData"),Object.defineProperty(o,"__esModule",{value:!0}),o.BuffId=void 0;var r,i=t("./SkillConst");(function(t){t[t.NULL=0]="NULL",t[t.KongCheng=1]="KongCheng"})(r=o.BuffId||(o.BuffId={})),o.default=function(t){return new c(a[t])};var c=function(){return function(t){this.name=t.name,this.icon=t.icon,this.dotime=t.dotime,this.continued=t.continued,this.type=t.type,this.func=t.func}}(),a=((n={})[r.KongCheng]={name:"\u7a7a\u57ce",icon:"",dotime:i.BuffTime.onAttack,type:i.BuffType.Reduce,continued:0,func:function(t,e){return 0}},n);cc._RF.pop()},{"./SkillConst":"SkillConst"}],Const:[function(t,e,o){"use strict";cc._RF.push(e,"9f654Hccu5ES6ZMaIiGjeYn","Const"),Object.defineProperty(o,"__esModule",{value:!0}),o.HERO_COUNT=o.MAX_DEFENCE=o.MAX_ENERGY=o.Arms_word=o.Arms=o.GUA_XIANG=o.CAMPS=o.EventType=void 0,function(t){t.TABLE_INIT_OVER="table_init_over",t.HERO_ATTACK="hero_attack",t.HERO_ON_ATTACK="hero_on_attack",t.CHECK_GUA="check_gua"}(o.EventType||(o.EventType={})),function(t){t[t.LEFT=0]="LEFT",t[t.RIGHT=1]="RIGHT"}(o.CAMPS||(o.CAMPS={})),function(t){t[t.QIAN=0]="QIAN",t[t.KAN=1]="KAN",t[t.GEN=2]="GEN",t[t.ZHEN=3]="ZHEN",t[t.XUN=4]="XUN",t[t.LI=5]="LI",t[t.KUN=6]="KUN",t[t.DUI=7]="DUI"}(o.GUA_XIANG||(o.GUA_XIANG={})),function(t){t[t.Gong=0]="Gong",t[t.Dao=1]="Dao",t[t.Qi=2]="Qi",t[t.Dun=3]="Dun",t[t.Che=4]="Che",t[t.Jun=5]="Jun",t[t.Qiang=6]="Qiang"}(o.Arms||(o.Arms={})),o.Arms_word=["\u5f13","\u5200","\u9a91","\u76fe","\u8f66","\u519b","\u67aa"],o.MAX_ENERGY=100,o.MAX_DEFENCE=100,o.HERO_COUNT=5,cc._RF.pop()},{}],EventManager:[function(t,e,o){"use strict";cc._RF.push(e,"846efnL7PFNDoxx7jZsg5Mw","EventManager"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function t(){}return t.emit=function(t,e){var o=new cc.Event.EventCustom(t,!0);null!==e&&o.setUserData(e),this._target.dispatchEvent(o)},t.on=function(t,e,o,n){this._target.on(t,e,o,n)},t.off=function(t,e,o){this._target.off(t,e,o)},t._target=new cc.EventTarget,t}();o.default=n,cc._RF.pop()},{}],GameModel:[function(t,e,o){"use strict";cc._RF.push(e,"07c5fo94rFHc5BOsxT7ODC9","GameModel"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("../common/Const"),r=function(){function t(){}return t.calculateDamage=function(t,e){return Math.ceil(t*(n.MAX_DEFENCE-e)/n.MAX_DEFENCE)},t}();o.default=r,cc._RF.pop()},{"../common/Const":"Const"}],GameView:[function(t,e,o){"use strict";cc._RF.push(e,"cf647gIawpJX6Y5aoFpH4nR","GameView");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,c=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(c=(i<3?r(c):i>3?r(e,o,c):r(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var i=t("../common/Const"),c=t("../common/EventManager"),a=t("../common/Tools"),s=t("../prefab/Hero"),u=t("../ui/TableView"),f=t("../model/GameModel"),l=t("../ui/GuaView"),h=t("../ui/AdditionView"),p=t("../prefab/Gua"),d=t("../skill/SkillSystem"),_=cc._decorator,g=_.ccclass,y=_.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bg=null,e.table=null,e.hero=null,e.gameBtn=null,e.guaView=null,e.additionView=null,e.leftList=[],e.rightList=[],e.labelpool=new cc.NodePool,e.btnGfx=null,e}return n(e,t),e.prototype.onLoad=function(){d.default.instance.initGameView(this),this.initGameBtn(),c.default.on(i.EventType.TABLE_INIT_OVER,this.initHeros,this),c.default.on(i.EventType.HERO_ATTACK,this.playAttack,this),c.default.on(i.EventType.HERO_ON_ATTACK,this.onAttack,this),c.default.on(i.EventType.CHECK_GUA,this.checkGua,this)},e.prototype.onDestroy=function(){c.default.off(i.EventType.TABLE_INIT_OVER,this.initHeros,this),c.default.off(i.EventType.HERO_ATTACK,this.playAttack,this),c.default.off(i.EventType.HERO_ON_ATTACK,this.onAttack,this),c.default.off(i.EventType.CHECK_GUA,this.checkGua,this)},e.prototype.start=function(){var t=this;this.scheduleOnce(function(){a.default.setOffsetUV(t.bg)},0)},e.prototype.initGameBtn=function(){var t=this;this.btnGfx=this.gameBtn.getComponent(cc.Graphics);var e=this.gameBtn.getComponent(cc.Button);this.gameBtn.on(cc.Node.EventType.TOUCH_START,function(){e.interactable&&t.refreshGameBtn(cc.Color.GREEN)}),this.gameBtn.on(cc.Node.EventType.TOUCH_END,function(){e.interactable&&(t.beginNewRound(),e.interactable=!1,t.refreshGameBtn(cc.Color.GRAY))}),this.gameBtn.on(cc.Node.EventType.TOUCH_CANCEL,function(){e.interactable&&t.refreshGameBtn(cc.Color.RED)}),this.refreshGameBtn(cc.Color.RED)},e.prototype.refreshGameBtn=function(t){void 0===t&&(t=cc.Color.WHITE),this.btnGfx.clear(),this.btnGfx.fillColor=t,this.btnGfx.arc(0,0,this.gameBtn.width/2-4,0,360,!1),this.btnGfx.stroke(),this.btnGfx.fill()},e.prototype.initHeros=function(){for(var t=this.table.getRects(),e=t.slice(0,9),o=t.slice(9),n=1e4,r=function(t){var o=cc.instantiate(c.hero),r=o.getComponent(s.default);c.node.addChild(o);var a=Math.floor(Math.random()*e.length),u=e[a];e=e.filter(function(t){return!t.equals(u)});var f=c.table.node.convertToWorldSpaceAR(cc.v2(u.x+u.width/2,u.y+u.height/2)),l=c.node.convertToNodeSpaceAR(f);r.onInit(l,Math.floor(a/3),a%3,++n),r.camp=i.CAMPS.LEFT,c.leftList.push(o)},c=this,a=0;a<i.HERO_COUNT;++a)r();var u=function(t){var e=cc.instantiate(f.hero),r=e.getComponent(s.default);f.node.addChild(e);var c=Math.floor(Math.random()*o.length),a=o[c];o=o.filter(function(t){return!t.equals(a)});var u=f.table.node.convertToWorldSpaceAR(cc.v2(a.x+a.width/2,a.y+a.height/2)),l=f.node.convertToNodeSpaceAR(u);r.onInit(l,Math.floor(c/3),c%3,++n),r.camp=i.CAMPS.RIGHT,f.rightList.push(e)},f=this;for(a=0;a<i.HERO_COUNT;++a)u()},e.prototype.beginNewRound=function(){this.additionView.resetAddition(),this.guaView.newRound(!0)},e.prototype.doAttack=function(t,e){if(e>=9)return this.gameBtn.getComponent(cc.Button).interactable=!0,this.refreshGameBtn(cc.Color.RED),this.leftList.forEach(function(t){t.getComponent(s.default).checkBuff()}),void this.rightList.forEach(function(t){t.getComponent(s.default).checkBuff()});var o,n,r,c;switch(t){case i.CAMPS.LEFT:o=this.table.getRects().slice(0,9),n=this.leftList,r=i.CAMPS.RIGHT,c=e,o.sort(function(t,e){return t.x>e.x?-1:t.x<e.x?1:e.y-t.y});break;case i.CAMPS.RIGHT:o=this.table.getRects().slice(9),n=this.rightList,r=i.CAMPS.LEFT,c=e+1,o.sort(function(t,e){return t.x>e.x?1:t.x<e.x?-1:e.y-t.y});break;default:return void console.log("do attack erro===>",t,e)}var a=this.getHeroByRect(n,o[e]);a&&!a.isdead?a.sendAttack(r,c):this.doAttack(r,c)},e.prototype.getHeroByRect=function(t,e){var o,n=this,r=this.table.node.convertToWorldSpaceAR(cc.v2(e.x+e.width/2,e.y+e.height/2));return t.forEach(function(t){var e=t.getComponent(s.default);n.node.convertToWorldSpaceAR(e.pos).equals(r)&&(o=e)}),o},e.prototype.resetGame=function(){for(var t=this.table.getRects(),e=t.slice(0,9),o=t.slice(9),n=1e4,r=function(t){var o=c.leftList[t].getComponent(s.default),r=Math.floor(Math.random()*e.length),i=e[r];e=e.filter(function(t){return!t.equals(i)});var a=c.table.node.convertToWorldSpaceAR(cc.v2(i.x+i.width/2,i.y+i.height/2)),u=c.node.convertToNodeSpaceAR(a);o.onInit(u,Math.floor(r/3),r%3,++n)},c=this,a=0;a<i.HERO_COUNT;++a)r(a);var u=function(t){var r=f.rightList[t].getComponent(s.default),i=Math.floor(Math.random()*e.length),c=o[i];o=o.filter(function(t){return!t.equals(c)});var a=f.table.node.convertToWorldSpaceAR(cc.v2(c.x+c.width/2,c.y+c.height/2)),u=f.node.convertToNodeSpaceAR(a);r.onInit(u,Math.floor(i/3),i%3,++n)},f=this;for(a=0;a<i.HERO_COUNT;++a)u(a)},e.prototype.playAttack=function(t){var e=t.getUserData(),o=this.getAttackHero(e),n=o[0],r=o[1],i=this.getRandomTarget(n);i&&r.doAttack(i)},e.prototype.getAttackHero=function(t){var e,o,n=t.camp;switch(n){case i.CAMPS.LEFT:e=this.leftList;break;case i.CAMPS.RIGHT:e=this.rightList;break;default:return void console.log("get hero error==>",t)}return e.forEach(function(e){e.getComponent(s.default).hero_id!==t.id||(o=e.getComponent(s.default))}),[n,o]},e.prototype.getRandomTarget=function(t){var e;switch(t){case i.CAMPS.LEFT:e=this.rightList.filter(function(t){return!t.getComponent(s.default).isdead});break;case i.CAMPS.RIGHT:e=this.leftList.filter(function(t){return!t.getComponent(s.default).isdead});break;default:return void console.log("get target error==>",t)}if(0!==e.length)return e[Math.floor(Math.random()*e.length)].getComponent(s.default)},e.prototype.checkGameOver=function(t){var e=this.leftList.filter(function(t){return!t.getComponent(s.default).isdead}),o=this.rightList.filter(function(t){return!t.getComponent(s.default).isdead});e.length<=0||o.length<=0||this.doAttack(t.camp,t.index)},e.prototype.onAttack=function(t){var e=this,o=t.getUserData(),n=o.target,r=f.default.calculateDamage(o.from.attack,n.defence);r=n.onAttack(r);var i=this.getLabel();i.string="-"+r,i.node.color=cc.Color.RED;var c=n.node.parent.convertToWorldSpaceAR(n.pos),a=this.node.convertToNodeSpaceAR(c);cc.tween(i.node).set({x:a.x,y:a.y+30,opacity:255}).to(.5,{y:a.y+50,opacity:0}).call(function(){e.labelpool.put(i.node)}).start(),this.scheduleOnce(function(){e.checkGameOver(o)},.2)},e.prototype.getLabel=function(){var t=null;return this.labelpool.size()>0?t=this.labelpool.get():((t=new cc.Node).scale=.5,t.addComponent(cc.Label)),this.node.addChild(t),t.getComponent(cc.Label)},e.prototype.checkGua=function(t){var e=this,o=t.getUserData();this.leftList.forEach(function(t){t.getComponent(s.default).resetAddition()}),this.rightList.forEach(function(t){t.getComponent(s.default).resetAddition()}),o.forEach(function(t){var o=t[0].getComponent(p.default).getCheckId(!1);e.additionView.doAddition(o,t.length).forEach(function(t){e.leftList.forEach(function(e){e.getComponent(s.default).doAddition(t.arm,t.attack,t.defence,t.energy)}),e.rightList.forEach(function(e){e.getComponent(s.default).doAddition(t.arm,t.attack,t.defence,t.energy)})})}),this.doAttack(i.CAMPS.LEFT,0)},e.prototype.getHeroList=function(t){switch(t){case i.CAMPS.LEFT:return this.leftList;case i.CAMPS.RIGHT:return this.rightList}return[]},r([y(cc.Sprite)],e.prototype,"bg",void 0),r([y(u.default)],e.prototype,"table",void 0),r([y(cc.Prefab)],e.prototype,"hero",void 0),r([y(cc.Node)],e.prototype,"gameBtn",void 0),r([y(l.default)],e.prototype,"guaView",void 0),r([y(h.default)],e.prototype,"additionView",void 0),e=r([g],e)}(cc.Component);o.default=m,cc._RF.pop()},{"../common/Const":"Const","../common/EventManager":"EventManager","../common/Tools":"Tools","../model/GameModel":"GameModel","../prefab/Gua":"Gua","../prefab/Hero":"Hero","../skill/SkillSystem":"SkillSystem","../ui/AdditionView":"AdditionView","../ui/GuaView":"GuaView","../ui/TableView":"TableView"}],GuaView:[function(t,e,o){"use strict";cc._RF.push(e,"35be0C2muBG9ooB3KYy8tBa","GuaView");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,c=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(c=(i<3?r(c):i>3?r(e,o,c):r(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var i=t("../prefab/Gua"),c=t("../common/EventManager"),a=t("../common/Const"),s=cc._decorator,u=s.ccclass,f=s.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.gua=null,e.guaNodes=[],e.gfx=null,e}return n(e,t),e.prototype.onLoad=function(){this.gfx=this.node.getComponent(cc.Graphics),this.drawRect()},e.prototype.start=function(){this.newRound()},e.prototype.drawRect=function(){this.gfx.moveTo(-this.node.height/2,-this.node.height/2),this.gfx.rect(-this.node.height/2,-this.node.height/2,this.node.height,this.node.height),this.gfx.stroke()},e.prototype.newRound=function(t){if(void 0===t&&(t=!1),0===this.guaNodes.length)for(var e=this.node.height/6,o=0;o<6;++o){for(var n=[],r=0;r<6;++r){var c=cc.instantiate(this.gua);this.node.addChild(c),n.push(c),c.x=5*-e/2+o*e,c.y=5*e/2-r*e}this.guaNodes.push(n)}this.guaNodes.forEach(function(t){t.forEach(function(t){t.getComponent(i.default).drawRandomGua()})}),t&&this.checkGua()},e.prototype.checkGua=function(){for(var t=[],e=0;e<this.guaNodes.length;++e)for(var o=0;o<this.guaNodes[e].length;++o){var n=this.guaNodes[e][o],r=[];r.push(n);var s=n.getComponent(i.default).getCheckId();null!==s&&(this.checkGuaItem(e-1,o,s,r),this.checkGuaItem(e,o-1,s,r),this.checkGuaItem(e,o+1,s,r),this.checkGuaItem(e+1,o,s,r),r.length>=3&&(r.forEach(function(t){t.getComponent(i.default).setCheck()}),t.push(r)))}c.default.emit(a.EventType.CHECK_GUA,t)},e.prototype.checkGuaItem=function(t,e,o,n){if(this.guaNodes[t]&&this.guaNodes[t][e]){var r=this.guaNodes[t][e];-1==n.indexOf(r)&&r.getComponent(i.default).getCheckId()===o&&(n.push(r),this.checkGuaItem(t-1,e,o,n),this.checkGuaItem(t,e-1,o,n),this.checkGuaItem(t,e+1,o,n),this.checkGuaItem(t+1,e,o,n))}},r([f(cc.Prefab)],e.prototype,"gua",void 0),e=r([u],e)}(cc.Component);o.default=l,cc._RF.pop()},{"../common/Const":"Const","../common/EventManager":"EventManager","../prefab/Gua":"Gua"}],Gua:[function(t,e,o){"use strict";cc._RF.push(e,"56b0dsH3G1LR4E3H+mZJAgN","Gua");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,c=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(c=(i<3?r(c):i>3?r(e,o,c):r(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var i=t("../common/Const"),c=cc._decorator,a=c.ccclass,s=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.gfx=null,e.width=0,e.isCheck=!1,e}return n(e,t),e.prototype.onLoad=function(){this.gfx=this.node.getComponent(cc.Graphics),this.width=this.node.width},e.prototype.drawRandomGua=function(){this.isCheck=!1,this.guaId=Math.floor(8*Math.random()),this.drawGua(this.guaId)},e.prototype.setCheck=function(){this.isCheck=!0,this.drawGua(this.guaId)},e.prototype.getCheckId=function(t){return void 0===t&&(t=!0),t&&this.isCheck?null:this.guaId},e.prototype.drawGua=function(t){switch(this.gfx.clear(),t){case i.GUA_XIANG.QIAN:this.drawQianGua();break;case i.GUA_XIANG.KAN:this.drawKanGua();break;case i.GUA_XIANG.GEN:this.drawGenGua();break;case i.GUA_XIANG.ZHEN:this.drawZhenGua();break;case i.GUA_XIANG.XUN:this.drawXunGua();break;case i.GUA_XIANG.LI:this.drawLiGua();break;case i.GUA_XIANG.KUN:this.drawKunGua();break;case i.GUA_XIANG.DUI:this.drawDuiGua()}},e.prototype.drawQianGua=function(){this.drawBackGround(this.isCheck?cc.color(255,255,0,255):cc.Color.WHITE),this.drawYao(1,0),this.drawYao(1,1),this.drawYao(1,2)},e.prototype.drawKanGua=function(){this.drawBackGround(this.isCheck?cc.color(0,0,128,255):cc.Color.WHITE),this.drawYao(0,0),this.drawYao(1,1),this.drawYao(0,2)},e.prototype.drawGenGua=function(){this.drawBackGround(this.isCheck?cc.color(128,128,0,255):cc.Color.WHITE),this.drawYao(1,0),this.drawYao(0,1),this.drawYao(0,2)},e.prototype.drawZhenGua=function(){this.drawBackGround(this.isCheck?cc.color(0,0,255,255):cc.Color.WHITE),this.drawYao(0,0),this.drawYao(0,1),this.drawYao(1,2)},e.prototype.drawXunGua=function(){this.drawBackGround(this.isCheck?cc.color(192,192,192,255):cc.Color.WHITE),this.drawYao(1,0),this.drawYao(1,1),this.drawYao(0,2)},e.prototype.drawLiGua=function(){this.drawBackGround(this.isCheck?cc.color(255,0,0,255):cc.Color.WHITE),this.drawYao(1,0),this.drawYao(0,1),this.drawYao(1,2)},e.prototype.drawKunGua=function(){this.drawBackGround(this.isCheck?cc.color(192,192,0,255):cc.Color.WHITE),this.drawYao(0,0),this.drawYao(0,1),this.drawYao(0,2)},e.prototype.drawDuiGua=function(){this.drawBackGround(this.isCheck?cc.color(192,192,64,255):cc.Color.WHITE),this.drawYao(0,0),this.drawYao(1,1),this.drawYao(1,2)},e.prototype.drawBackGround=function(t){this.gfx.fillColor=t,this.gfx.moveTo(0,0),this.gfx.arc(0,0,this.width/2,0,360,!1),this.gfx.fill()},e.prototype.drawYao=function(t,e){var o=this.width-40,n=cc.v2(-o/2,-20*e+15);0==t?(this.gfx.fillColor=cc.Color.BLACK,this.gfx.moveTo(n.x,n.y),this.gfx.fillRect(n.x,n.y,o/2-5,10),this.gfx.moveTo(5,n.y),this.gfx.fillRect(5,n.y,o/2-5,10)):(this.gfx.moveTo(n.x,n.y),this.gfx.fillColor=cc.Color.BLACK,this.gfx.fillRect(n.x,n.y,o,10))},e=r([a],e)}(cc.Component));o.default=s,cc._RF.pop()},{"../common/Const":"Const"}],Hero:[function(t,e,o){"use strict";cc._RF.push(e,"0f1124T45JGQrc2TGpj9mtf","Hero");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,c=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(c=(i<3?r(c):i>3?r(e,o,c):r(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var i=t("../common/Const"),c=t("../common/EventManager"),a=t("../skill/SkillComponent"),s=t("../skill/SkillData"),u=t("../skill/SkillSystem"),f=t("../skill/SkillConst"),l=t("../skill/BuffComponent"),h=cc._decorator,p=h.ccclass,d=h.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lb_name=null,e.lb_hp=null,e.lb_data=null,e.pb_hp=null,e.pb_eg=null,e.lb_arm=null,e.node_skill=null,e.node_buff=null,e._hp=0,e._maxHp=0,e._hero_name="",e._attack=0,e._defence=0,e._dead=!1,e._camp=0,e._pos=cc.v2(0,0),e._energy=0,e._hero_id=0,e._nextCamp=0,e._nextIndex=0,e._buffAttack=0,e._buffDefence=0,e._initAttack=0,e._initDefence=0,e._col=0,e._row=0,e}return n(e,t),Object.defineProperty(e.prototype,"hp",{get:function(){return this._hp},set:function(t){this._hp=Math.min(Math.round(t),this.maxHp),this.hp<=0?this.isdead=!0:(this.lb_hp.string=this.hp+"/"+this.maxHp,this.pb_hp.progress=this.hp/this.maxHp)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxHp",{get:function(){return this._maxHp},set:function(t){var e=Math.round(t);this._maxHp=e,this.hp=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"heroname",{get:function(){return this._hero_name},set:function(t){this._hero_name=t,this.lb_name.string=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"attack",{get:function(){return this._attack},set:function(t){this._attack=Math.round(t),this.displayData()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"defence",{get:function(){return this._defence},set:function(t){this._defence=Math.min(Math.round(t),i.MAX_DEFENCE),this.displayData()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isdead",{get:function(){return this._dead},set:function(t){this._dead=t,this.node.active=!t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"camp",{get:function(){return this._camp},set:function(t){this._camp=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pos",{get:function(){return this._pos},set:function(t){this._pos.equals(t)||(this._pos=t),this.node.setPosition(this.pos)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"energy",{get:function(){return this._energy},set:function(t){this._energy=Math.min(t,i.MAX_ENERGY),this.pb_eg.progress=this.energy/i.MAX_ENERGY},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hero_id",{get:function(){return this._hero_id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"arm",{get:function(){return this._arm},set:function(t){this._arm=t,this.lb_arm.string=i.Arms_word[t]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"buffAttack",{get:function(){return this._buffAttack},set:function(t){this._buffAttack=t,this.attack=this.initAttack*(1+this._buffAttack)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"buffDefence",{get:function(){return this._buffDefence},set:function(t){this._buffDefence=t,this.defence=this.initDefence*(1+this._buffDefence)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"initAttack",{get:function(){return this._initAttack},set:function(t){this._initAttack=t,this.attack=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"initDefence",{get:function(){return this._initDefence},set:function(t){this._initDefence=t,this.defence=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"col",{get:function(){return this._col},set:function(t){this._col=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"row",{get:function(){return this._row},set:function(t){this._row=t},enumerable:!1,configurable:!0}),e.prototype.onInit=function(t,e,o,n){var r=Object.keys(i.Arms).filter(function(t){return isNaN(parseInt(t))}),c=["\u66f9\u64cd","\u5218\u5907","\u5b59\u6743","\u9646\u900a","\u5468\u745c","\u8bf8\u845b\u4eae","\u53f8\u9a6c\u61ff","\u90ed\u5609","\u8340\u5f67","\u620f\u5fd7\u624d","\u8d3e\u8be9","\u9c81\u8083","\u6cd5\u6b63","\u59dc\u7ef4","\u8d75\u4e91","\u5415\u5e03","\u5173\u7fbd","\u5f20\u98de"],u=Math.random();if(this.heroname=c[Math.floor(u*c.length)],this.maxHp=200+100*u,this.initAttack=50+20*u,this.initDefence=20+10*u,this.arm=Math.floor(u*r.length),this.isdead=!1,this.pos=t,this.energy=0,this._hero_id=n,this.node.zIndex=0,this.col=e,this.row=o,this.heroname===c[5]){var f=this.node_skill.addComponent(a.default);this.scheduleOnce(function(){f.initSkill(s.SkillId.KongCheng)},0)}},e.prototype.sendAttack=function(t,e){this._nextCamp=t,this._nextIndex=e;var o={camp:this.camp,id:this.hero_id};this.energy>=i.MAX_ENERGY&&u.default.instance.doCheckSkill(this,f.SkillType.Attack)||c.default.emit(i.EventType.HERO_ATTACK,o)},e.prototype.doAttack=function(t){var e=this;this.node.zIndex=1;var o=this.camp===i.CAMPS.LEFT?-1:1,n=t.pos.add(cc.v2(.9*this.node.width*o,0));cc.tween(this.node).to(.1,{x:n.x,y:n.y},{easing:"cubicOut"}).call(function(){c.default.emit(i.EventType.HERO_ON_ATTACK,{target:t,from:e,camp:e._nextCamp,index:e._nextIndex})}).to(.1,{x:this.pos.x,y:this.pos.y},{easing:"cubicOut"}).call(function(){e.node.zIndex=0}).start()},e.prototype.onAttack=function(t){var e=this,o=u.default.instance.doCheckBuff(this,f.BuffTime.onAttack);return o&&o.buffType===f.BuffType.Reduce&&(t=o.doFunc(this,t)),cc.tween(this.node).delay(.1).to(.05,{scale:.8}).call(function(){e.hp-=t}).to(.05,{scale:1}).start(),t},e.prototype.resetAddition=function(){this.buffAttack=0,this.buffDefence=0},e.prototype.doAddition=function(t,e,o,n){t===this.arm&&(this.buffAttack=e,this.buffDefence=o,this.energy+=n,this.energy>=i.MAX_ENERGY&&u.default.instance.doCheckSkill(this,f.SkillType.Before)&&(this.energy=0))},e.prototype.checkBuff=function(){this.node_buff.getComponents(l.default).forEach(function(t){t.continued<=0&&t.destroy()})},e.prototype.displayData=function(){var t="\u653b:"+this.attack+" \u9632:"+this.defence;this.lb_data.string=t},r([d(cc.Label)],e.prototype,"lb_name",void 0),r([d(cc.Label)],e.prototype,"lb_hp",void 0),r([d(cc.Label)],e.prototype,"lb_data",void 0),r([d(cc.ProgressBar)],e.prototype,"pb_hp",void 0),r([d(cc.ProgressBar)],e.prototype,"pb_eg",void 0),r([d(cc.Label)],e.prototype,"lb_arm",void 0),r([d(cc.Node)],e.prototype,"node_skill",void 0),r([d(cc.Node)],e.prototype,"node_buff",void 0),e=r([p],e)}(cc.Component);o.default=_,cc._RF.pop()},{"../common/Const":"Const","../common/EventManager":"EventManager","../skill/BuffComponent":"BuffComponent","../skill/SkillComponent":"SkillComponent","../skill/SkillConst":"SkillConst","../skill/SkillData":"SkillData","../skill/SkillSystem":"SkillSystem"}],ListView:[function(t,e,o){"use strict";cc._RF.push(e,"9d7b5TdwExE/pkV2ieS6idW","ListView");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,c=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(c=(i<3?r(c):i>3?r(e,o,c):r(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,c=i.ccclass,a=(i.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.gfx=null,e}return n(e,t),e.prototype.onLoad=function(){this.gfx=this.node.getComponent(cc.Graphics)},e.prototype.start=function(){this.scheduleOnce(this.initStroke,0)},e.prototype.initStroke=function(){this.gfx.rect(-this.node.width/2,-this.node.height/2,this.node.width,this.node.height),this.gfx.stroke()},e=r([c],e)}(cc.Component));o.default=a,cc._RF.pop()},{}],SkillComponent:[function(t,e,o){"use strict";cc._RF.push(e,"7d0d6P3LVBOs6tWI6z+WU64","SkillComponent");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,c=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(c=(i<3?r(c):i>3?r(e,o,c):r(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var i=t("./SkillData"),c=cc._decorator,a=c.ccclass,s=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._skillId=i.SkillId.NULL,e}return n(e,t),Object.defineProperty(e.prototype,"skillId",{get:function(){return this._skillId},set:function(t){if(this._skillId!==t){this._skillId=t;var e=i.default(t);this.skillName=e.name,this.skillIcon=e.icon,this.skillDes=e.des,this.skillType=e.type,this.skillRule=e.rule,this.skillTarget=e.target,this.doFunc=e.func}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"skillName",{get:function(){return this._skillName},set:function(t){this._skillName=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"skillIcon",{get:function(){return this._skillIcon},set:function(t){this._skillIcon=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"skillDes",{get:function(){return this._skillDes},set:function(t){this._skillDes=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"skillType",{get:function(){return this._skillType},set:function(t){this._skillType=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"skillRule",{get:function(){return this._skillRule},set:function(t){this._skillRule=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"skillTarget",{get:function(){return this._skillTarget},set:function(t){this._skillTarget=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"doFunc",{get:function(){return this._doFunc},set:function(t){this._doFunc=t},enumerable:!1,configurable:!0}),e.prototype.initSkill=function(t){this.skillId=t},e=r([a],e)}(cc.Component));o.default=s,cc._RF.pop()},{"./SkillData":"SkillData"}],SkillConst:[function(t,e,o){"use strict";cc._RF.push(e,"2c9577RbTBMtaJLbT28D4/m","SkillConst"),Object.defineProperty(o,"__esModule",{value:!0}),o.BuffType=o.BuffTime=o.ChooseRule=o.SkillTarget=o.SkillType=void 0,function(t){t[t.Before=0]="Before",t[t.Attack=1]="Attack",t[t.Recover=2]="Recover"}(o.SkillType||(o.SkillType={})),function(t){t[t.Self=0]="Self",t[t.One=1]="One",t[t.Col=2]="Col",t[t.Row=3]="Row",t[t.All=4]="All",t[t.OtherOne=5]="OtherOne",t[t.OtherCol=6]="OtherCol",t[t.OtherRow=7]="OtherRow",t[t.OtherAll=8]="OtherAll"}(o.SkillTarget||(o.SkillTarget={})),function(t){t[t.Radom=0]="Radom",t[t.MaxHp=1]="MaxHp",t[t.MinHp=2]="MinHp",t[t.MaxAttack=3]="MaxAttack",t[t.MinAttack=4]="MinAttack",t[t.MaxDefence=5]="MaxDefence",t[t.MinDefence=6]="MinDefence",t[t.Through=7]="Through",t[t.FirstCol=8]="FirstCol",t[t.SecondCol=9]="SecondCol",t[t.LastCol=10]="LastCol"}(o.ChooseRule||(o.ChooseRule={})),function(t){t[t.doAttack=0]="doAttack",t[t.onAttack=1]="onAttack",t[t.onSkill=2]="onSkill"}(o.BuffTime||(o.BuffTime={})),function(t){t[t.Reduce=0]="Reduce",t[t.Recover=1]="Recover",t[t.Other=2]="Other"}(o.BuffType||(o.BuffType={})),cc._RF.pop()},{}],SkillData:[function(t,e,o){"use strict";var n;cc._RF.push(e,"ebcddaqNu1CGar7A7Ake7BG","SkillData"),Object.defineProperty(o,"__esModule",{value:!0}),o.SkillId=void 0;var r,i=t("./SkillConst"),c=t("./BuffComponent"),a=t("./BuffData");(function(t){t[t.NULL=0]="NULL",t[t.KongCheng=1]="KongCheng"})(r=o.SkillId||(o.SkillId={})),o.default=function(t){return new s(u[t])};var s=function(){return function(t){this.name=t.name,this.icon=t.icon,this.des=t.des,this.type=t.type,this.rule=t.rule,this.target=t.target,this.func=t.func}}(),u=((n={})[r.KongCheng]={name:"\u7a7a\u57ce\u8ba1",icon:"",des:"\u8fdb\u5165\u7a7a\u57ce\u72b6\u6001\uff0c\u672c\u56de\u5408\u514d\u75ab\u666e\u901a\u653b\u51fb\u4f24\u5bb3",type:i.SkillType.Before,rule:i.ChooseRule.Radom,target:i.SkillTarget.Self,func:function(t,e){t.node_buff.addComponent(c.default).initBuff(a.BuffId.KongCheng)}},n);cc._RF.pop()},{"./BuffComponent":"BuffComponent","./BuffData":"BuffData","./SkillConst":"SkillConst"}],SkillSystem:[function(t,e,o){"use strict";cc._RF.push(e,"f37b8jXhXxH3rhQcTQF0Rgu","SkillSystem"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("../prefab/Hero"),r=t("./SkillConst"),i=t("./SkillComponent"),c=t("../common/Const"),a=t("./BuffComponent"),s=function(){function t(){}return Object.defineProperty(t,"instance",{get:function(){return this._instance},enumerable:!1,configurable:!0}),t.prototype.initGameView=function(t){this.game=t},t.prototype.doCheckSkill=function(t,e){var o=this,n=!1;return t.node_skill.getComponents(i.default).forEach(function(i){if(i.skillType===e){n=!0;var c=void 0;i.skillTarget!==r.SkillTarget.Self&&(c=o.getTargetsByType(t,i)),i.doFunc(t,c)}}),n},t.prototype.doCheckBuff=function(t,e){var o=null;return t.node_buff.getComponents(a.default).forEach(function(t){t.buffTime!==e||(o=t)}),o},t.prototype.getTargetsByType=function(t,e){var o;switch(e.skillTarget){case r.SkillTarget.One:case r.SkillTarget.Col:case r.SkillTarget.Row:case r.SkillTarget.All:o=this.game.getHeroList(t.camp);break;case r.SkillTarget.OtherOne:case r.SkillTarget.OtherCol:case r.SkillTarget.OtherRow:case r.SkillTarget.OtherAll:o=this.game.getHeroList(t.camp===c.CAMPS.LEFT?c.CAMPS.RIGHT:c.CAMPS.LEFT);break;default:return[]}return this.getTargets(o,e)},t.prototype.getTargets=function(t,e){var o=[];switch(e.skillTarget){case r.SkillTarget.One:case r.SkillTarget.OtherOne:o.push(this.getTargetByRule(t,e));break;case r.SkillTarget.Col:case r.SkillTarget.OtherCol:var i=this.getCol(t);e.skillRule===r.ChooseRule.Radom?o=i[Math.floor(Math.random()*i.length)]:e.skillRule===r.ChooseRule.FirstCol?o=i[0]:e.skillRule===r.ChooseRule.SecondCol?o=i[1]||i[0]:e.skillRule===r.ChooseRule.LastCol&&(o=i[i.length-1]);break;case r.SkillTarget.Row:case r.SkillTarget.OtherRow:var c=void 0;if(e.skillRule===r.ChooseRule.Radom)o=(c=this.getRow(t))[Math.floor(Math.random()*c.length)];else if(e.skillRule===r.ChooseRule.Through){var a=this.getCol(t)[0],s=a[Math.floor(Math.random()*a.length)];o=(c=this.getRow(t,!0))[s.getComponent(n.default).row]}break;case r.SkillTarget.All:case r.SkillTarget.OtherAll:o=t}return o},t.prototype.getCol=function(t,e){void 0===e&&(e=!1);var o=[[],[],[]];if(t.forEach(function(t){var e=t.getComponent(n.default);e.isdead||o[e.col].push(e)}),!e){var r=[];return o.forEach(function(t){t.length>0&&r.push(t)}),r}return o},t.prototype.getRow=function(t,e){void 0===e&&(e=!1);var o=[[],[],[]];if(t.forEach(function(t){var e=t.getComponent(n.default);e.isdead||o[e.row].push(e)}),!e){var r=[];return o.forEach(function(t){t.length>0&&r.push(t)}),r}return o},t.prototype.getTargetByRule=function(t,e){var o,i=0,c=1e7;switch(e.skillRule){case r.ChooseRule.MaxHp:return t.forEach(function(t){var e=t.getComponent(n.default);!e.isdead&&e.hp>i&&(i=e.hp,o=t)}),o;case r.ChooseRule.MinHp:return t.forEach(function(t){var e=t.getComponent(n.default);!e.isdead&&e.hp<c&&(c=e.hp,o=t)}),o;case r.ChooseRule.MaxAttack:return t.forEach(function(t){var e=t.getComponent(n.default);!e.isdead&&e.attack>i&&(i=e.attack,o=t)}),o;case r.ChooseRule.MinAttack:return t.forEach(function(t){var e=t.getComponent(n.default);!e.isdead&&e.attack<c&&(c=e.attack,o=t)}),o;case r.ChooseRule.MaxDefence:return t.forEach(function(t){var e=t.getComponent(n.default);!e.isdead&&e.defence>i&&(i=e.defence,o=t)}),o;case r.ChooseRule.MaxDefence:return t.forEach(function(t){var e=t.getComponent(n.default);!e.isdead&&e.defence<c&&(c=e.defence,o=t)}),o;case r.ChooseRule.Radom:default:return t[Math.floor(t.length*Math.random())]}},t._instance=new t,t}();o.default=s,cc._RF.pop()},{"../common/Const":"Const","../prefab/Hero":"Hero","./BuffComponent":"BuffComponent","./SkillComponent":"SkillComponent","./SkillConst":"SkillConst"}],TableView:[function(t,e,o){"use strict";cc._RF.push(e,"81a0fX1hB5DTb743hVLsigd","TableView");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,c=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(c=(i<3?r(c):i>3?r(e,o,c):r(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var i=t("../common/Const"),c=t("../common/EventManager"),a=cc._decorator,s=a.ccclass,u=a.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.strokeGfx=null,e.fillGfx=null,e.rects=[],e}return n(e,t),e.prototype.onLoad=function(){this.fillGfx=this.node.getComponent(cc.Graphics)},e.prototype.start=function(){this.scheduleOnce(this.initStroke,0)},e.prototype.initStroke=function(){this.strokeGfx.clear(),this.drawTable(!0),this.drawTable(!1),c.default.emit(i.EventType.TABLE_INIT_OVER)},e.prototype.checkCross=function(t){var e=this.node.convertToNodeSpaceAR(t),o=new cc.Rect(e.x-50,e.y-50,100,100),n=this.fillGfx,r=0,i=0;this.rects.forEach(function(t,e){if(t.intersects(o)){var n=new cc.Rect;t.intersection(n,o);var c=n.width*n.height;(r=Math.max(r,c))===c&&(i=e)}}),n.clear(),this.rects.forEach(function(t,e){0!==r&&i===e&&(n.fillColor=cc.color(0,255,0,255),n.fillRect(t.x,t.y,t.width,t.height))})},e.prototype.drawTable=function(t){var e=this.strokeGfx,o=this.node.width,n=-this.node.height/2,r=o/2-300,i=t?-1:1;e.moveTo((o/2-r/2)*i,n),e.lineTo(r/2*i,n),e.lineTo(r/2*i,n+300),e.lineTo((o/2-r/2)*i,n+300),e.close(),e.moveTo((r/2+100)*i,n),e.lineTo((r/2+100)*i,n+300),e.moveTo((r/2+200)*i,n),e.lineTo((r/2+200)*i,n+300),e.moveTo((o/2-r/2)*i,n+100),e.lineTo(r/2*i,n+100),e.moveTo((o/2-r/2)*i,n+200),e.lineTo(r/2*i,n+200),e.stroke();for(var c=0;c<3;++c)for(var a=0;a<3;++a){var s=(r/2+100*(c+(t?1:0)))*i,u=n+100*a,f=new cc.Rect(s,u,100,100);this.rects.push(f)}},e.prototype.getRects=function(){return this.rects},r([u(cc.Graphics)],e.prototype,"strokeGfx",void 0),e=r([s],e)}(cc.Component);o.default=f,cc._RF.pop()},{"../common/Const":"Const","../common/EventManager":"EventManager"}],Tools:[function(t,e,o){"use strict";cc._RF.push(e,"aed90YH+XFPlYsMJTe5Bq8J","Tools"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function t(){}return t.setOffsetUV=function(t,e,o){void 0===e&&(e="u_uvOffset"),void 0===o&&(o="u_uvRotated");var n,r,i,c,a=t.spriteFrame,s=a.uv,u=t.getMaterial(0);n=s[0],c=s[5],r=s[6],i=s[3];var f=new cc.Vec4(n,c,r,i),l=a.isRotated()?1:0;u.setProperty(e,f),u.setProperty(o,l)},t}();o.default=n,cc._RF.pop()},{}]},{},["Const","EventManager","Tools","GameModel","Addition","Gua","Hero","BuffComponent","BuffData","SkillComponent","SkillConst","SkillData","SkillSystem","AdditionView","GuaView","ListView","TableView","GameView"]);